name: YouTube Auto Pipeline
on:
  schedule:
    - cron: '0 9,14,19 * * *'  # 9AM, 2PM, 7PM UTC daily
  workflow_dispatch:

jobs:
  create-and-upload:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install system dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y ffmpeg
        
    - name: Install Python packages
      run: |
        pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: Run Real Pipeline
      env:
        # API Keys
        PEXELS_API_KEY: ${{ secrets.PEXELS_API_KEY }}
        STABILITY_API_KEY: ${{ secrets.STABILITY_API_KEY }}
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        YOUTUBE_API_KEY: ${{ secrets.YOUTUBE_API_KEY }}
        
        # Google OAuth
        GOOGLE_CLIENT_ID: ${{ secrets.GOOGLE_CLIENT_ID }}
        GOOGLE_CLIENT_SECRET: ${{ secrets.GOOGLE_CLIENT_SECRET }}
        GOOGLE_PROJECT_ID: ${{ secrets.GOOGLE_PROJECT_ID }}
      run: |
        echo "ğŸš€ STARTING REAL YOUTUBE AUTOMATION"
        echo "===================================="
        python real_pipeline.py
        echo "âœ… Real automation completed successfully!"
        
    - name: List Created Files
      run: |
        echo "ğŸ“ Created Files:"
        ls -la *.mp4 *.png *.json 2>/dev/null || echo "No output files"
        
    - name: Upload Video Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: generated-videos
        path: |
          *.mp4
          *.png
          pipeline_results.json
        
    - name: Success Notification
      run: |
        echo "ğŸ‰ REAL videos processed successfully!"
        echo "ğŸ“… Next run: Scheduled time"
        echo "â° System will run automatically 24/7"
