name: YouTube Monetization Automation

on:
  workflow_dispatch:
    inputs:
      topic:
        description: 'Video Topic'
        required: false
        default: 'Passive Income'
      title:
        description: 'Video Title'
        required: false  
        default: 'How I Make $500/Day with YouTube Automation'

jobs:
  monetize-youtube:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    
    steps:
    - name: üì• Checkout code
      uses: actions/checkout@v4
    
    - name: üêç Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
    
    - name: üì¶ Install System Dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y ffmpeg wget gnupg libgbm-dev
        
    - name: üîß Install Python Packages
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        playwright install chromium
        playwright install-deps
    
    - name: üé¨ Create Monetized Video
      env:
        VIDEO_TITLE: ${{ github.event.inputs.title || 'How I Make $500/Day with YouTube Automation' }}
      run: |
        echo "üí∞ Creating MONETIZED video: $VIDEO_TITLE"
        python video_creator.py
        
        if [ -f "monetized_video.mp4" ]; then
          echo "‚úÖ Video created: monetized_video.mp4"
          echo "üìè Size: $(du -h monetized_video.mp4)"
        else
          echo "‚ùå Video creation failed"
          exit 1
        fi
    
    - name: üì§ Auto-Upload to YouTube
      env:
        YOUTUBE_EMAIL: ${{ secrets.YOUTUBE_EMAIL }}
        YOUTUBE_PASSWORD: ${{ secrets.YOUTUBE_PASSWORD }}
      run: |
        if [ -n "$YOUTUBE_EMAIL" ] && [ -n "$YOUTUBE_PASSWORD" ]; then
          echo "üöÄ Starting REAL YouTube upload..."
          python youtube_uploader.py
        else
          echo "‚ö†Ô∏è YouTube credentials not set."
          echo "Add these GitHub Secrets to enable upload:"
          echo "1. YOUTUBE_EMAIL"
          echo "2. YOUTUBE_PASSWORD"
          echo "Video saved as artifact."
        fi
    
    - name: üíæ Save Video Artifact
      uses: actions/upload-artifact@v4
      with:
        name: youtube-video
        path: monetized_video.mp4
        retention-days: 30
    
    - name: üìä Monetization Report
      if: success()
      run: |
        echo "========================================"
        echo "üí∞ YOUTUBE MONETIZATION SYSTEM READY"
        echo "========================================"
        echo "Video: monetized_video.mp4"
        echo "Duration: 5 minutes (monetizable)"
        echo ""
        echo "ESTIMATED EARNINGS (per 1,000 views):"
        echo "‚Ä¢ YouTube Ads: $2-$10"
        echo "‚Ä¢ Monthly potential (10K views): $20-$100"
        echo "‚Ä¢ Monthly potential (100K views): $200-$1,000"
        echo ""
        echo "NEXT: Add YouTube credentials to upload"
        echo "========================================"
